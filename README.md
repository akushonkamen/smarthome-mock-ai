# SmartHome Mock AI

ä¸€ä¸ªåŸºäº LLM çš„æ™ºèƒ½å®¶å±…è‡ªåŠ¨åŒ–æ¨¡æ‹Ÿç³»ç»Ÿï¼Œé‡‡ç”¨"ä»¿çœŸä¼˜å…ˆ"(Simulation First) æ¶æ„è®¾è®¡ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·è¯­éŸ³/æ–‡æœ¬æŒ‡ä»¤                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LLM æ¨ç†å¼•æ“                             â”‚
â”‚         (GPT-4 / Claude / æœ¬åœ°æ¨¡å‹)                          â”‚
â”‚              ç†è§£è‡ªç„¶è¯­è¨€æ„å›¾                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Intent Parser (æ„å›¾è§£æå™¨)                 â”‚
â”‚    - æå–åŠ¨ä½œç±»å‹ (æ‰“å¼€/å…³é—­/è°ƒèŠ‚)                             â”‚
â”‚    - è¯†åˆ«è®¾å¤‡ç›®æ ‡ (ç¯å…‰/ç©ºè°ƒ/çª—å¸˜...)                          â”‚
â”‚    - è§£æå‚æ•°å€¼ (äº®åº¦/æ¸©åº¦/é¢œè‰²...)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Virtual Device Manager (è™šæ‹Ÿè®¾å¤‡ç®¡ç†å™¨)           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ è™šæ‹Ÿç¯å…‰è®¾å¤‡  â”‚  â”‚ è™šæ‹Ÿç©ºè°ƒè®¾å¤‡  â”‚  â”‚ è™šæ‹Ÿçª—å¸˜è®¾å¤‡  â”‚  ...  â”‚
â”‚  â”‚ - çŠ¶æ€æ¨¡æ‹Ÿ   â”‚  â”‚ - æ¸©åº¦æ¨¡æ‹Ÿ   â”‚  â”‚ - å¼€åˆæ¨¡æ‹Ÿ   â”‚         â”‚
â”‚  â”‚ - æ—¥å¿—è®°å½•   â”‚  â”‚ - èƒ½è€—æ¨¡æ‹Ÿ   â”‚  â”‚ - æ—¥å…‰æ¨¡æ‹Ÿ   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Event Bus (äº‹ä»¶æ€»çº¿)                        â”‚
â”‚         - è®¾å¤‡çŠ¶æ€å˜æ›´é€šçŸ¥                                     â”‚
â”‚         - åœºæ™¯è”åŠ¨è§¦å‘                                         â”‚
â”‚         - æ—¥å¿—æ”¶é›†ä¸ç›‘æ§                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **ğŸ¤– LLM é©±åŠ¨**: ä½¿ç”¨æ™ºè°±AI GLM-4æ¨¡å‹ç†è§£å¤æ‚çš„è‡ªç„¶è¯­è¨€æŒ‡ä»¤
- **ğŸ”§ Function Calling**: åŸºäº OpenAI å…¼å®¹çš„ Function Calling API å®ç°æ™ºèƒ½å·¥å…·è°ƒç”¨
- **ğŸ’¡ è™šæ‹Ÿè®¾å¤‡**: å®Œæ•´çš„è®¾å¤‡è¡Œä¸ºæ¨¡æ‹Ÿï¼Œæ— éœ€ç‰©ç†ç¡¬ä»¶
  - æ™ºèƒ½ç¯å…‰ (äº®åº¦ã€é¢œè‰²æ§åˆ¶)
  - æ™ºèƒ½æ¸©æ§å™¨ (æ¸©åº¦ã€æ¨¡å¼æ§åˆ¶)
  - æ™ºèƒ½é£æ‰‡ (å¼€å…³ã€é€Ÿåº¦æ§åˆ¶)
  - æ™ºèƒ½çª—å¸˜ (å¼€åˆã€ä½ç½®æ§åˆ¶)
  - æ™ºèƒ½é—¨é” (é”å®šã€è§£é”)
- **ğŸ¯ æ™ºèƒ½åœºæ™¯è¯†åˆ«**:
  - "æˆ‘è¦ç¡è§‰äº†" â†’ è‡ªåŠ¨å…³é—­æ‰€æœ‰ç¯å…‰
  - "å¤ªçƒ­äº†" â†’ è°ƒä½æ¸©åº¦æˆ–æ‰“å¼€é£æ‰‡
  - "æˆ‘è¦çœ‹ç”µè§†" â†’ è°ƒæš—ç¯å…‰å¹¶å…³é—­çª—å¸˜
  - "å‡ºé—¨äº†" â†’ å…³é—­æ‰€æœ‰ç¯å…‰å¹¶é”é—¨
- **ğŸ”„ å®æ—¶çŠ¶æ€ç®¡ç†**: æŸ¥è¯¢å’Œæ§åˆ¶æ‰€æœ‰è®¾å¤‡çŠ¶æ€
- **âš¡ CLI äº¤äº’ç•Œé¢**: å‹å¥½çš„å‘½ä»¤è¡Œäº¤äº’ä½“éªŒ

## ğŸ“ é¡¹ç›®ç»“æ„

```
smarthome-mock-ai/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â””â”€â”€ ci.yml              # CI/CD æµæ°´çº¿é…ç½®
â”œâ”€â”€ src/
â”‚   â””â”€â”€ smarthome_mock_ai/
â”‚       â”œâ”€â”€ __init__.py         # åŒ…åˆå§‹åŒ–
â”‚       â”œâ”€â”€ devices.py          # è™šæ‹Ÿè®¾å¤‡å®šä¹‰ (Light, Thermostat, Fan, Curtain, Door)
â”‚       â”œâ”€â”€ simulator.py        # è®¾å¤‡æ¨¡æ‹Ÿå™¨å’Œç®¡ç†å™¨
â”‚       â””â”€â”€ agent.py            # AI Agent (LLM + Function Calling)
â”œâ”€â”€ tests/                      # æµ‹è¯•ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_example.py         # ç¤ºä¾‹æµ‹è¯•
â”œâ”€â”€ main.py                     # CLI ç¨‹åºå…¥å£
â”œâ”€â”€ test_agent.py               # Agent æµ‹è¯•è„šæœ¬
â”œâ”€â”€ .env.example                # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ pyproject.toml              # Poetry é…ç½®
â””â”€â”€ README.md
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- Poetry (æ¨èçš„ä¾èµ–ç®¡ç†å·¥å…·)

### å®‰è£…

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/akushonkamen/smarthome-mock-ai.git
cd smarthome-mock-ai

# å®‰è£…ä¾èµ–
poetry install

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
poetry shell

# é…ç½® API Key (å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶å¹¶å¡«å…¥æ‚¨çš„ API Key)
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶,å¡«å…¥æ‚¨çš„æ™ºè°±AI API Key
```

### è¿è¡Œç¨‹åº

```bash
# å¯åŠ¨ CLI äº¤äº’ç•Œé¢
poetry run python main.py

# æˆ–æµ‹è¯• Agent åŠŸèƒ½
poetry run python test_agent.py
```

### CLI å‘½ä»¤

å¯åŠ¨å,æ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:

- **help** - æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯
- **status** - æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡çŠ¶æ€
- **devices** - åˆ—å‡ºæ‰€æœ‰å¯ç”¨è®¾å¤‡
- **reset** - é‡ç½®æ‰€æœ‰è®¾å¤‡
- **clear** - æ¸…ç©ºå±å¹•
- **exit/quit** - é€€å‡ºç¨‹åº

### è‡ªç„¶è¯­è¨€ç¤ºä¾‹

```bash
# ç¯å…‰æ§åˆ¶
ğŸ  æ‚¨çš„éœ€æ±‚ > æ‰“å¼€å®¢å…ç¯
ğŸ  æ‚¨çš„éœ€æ±‚ > æŠŠå§å®¤ç¯è°ƒæš—ä¸€ç‚¹
ğŸ  æ‚¨çš„éœ€æ±‚ > è®¾ç½®ç¯å…‰ä¸ºçº¢è‰²

# æ¸©åº¦æ§åˆ¶
ğŸ  æ‚¨çš„éœ€æ±‚ > å¤ªçƒ­äº†
ğŸ  æ‚¨çš„éœ€æ±‚ > æŠŠæ¸©åº¦è°ƒåˆ°25åº¦

# åœºæ™¯è‡ªåŠ¨åŒ–
ğŸ  æ‚¨çš„éœ€æ±‚ > æˆ‘è¦ç¡è§‰äº†
ğŸ  æ‚¨çš„éœ€æ±‚ > æˆ‘è¦çœ‹ç”µè§†
ğŸ  æ‚¨çš„éœ€æ±‚ > å‡ºé—¨äº†
ğŸ  æ‚¨çš„éœ€æ±‚ > å›å®¶å•¦
```

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
poetry run pytest

# è¿è¡Œæµ‹è¯•å¹¶æŸ¥çœ‹è¦†ç›–ç‡
poetry run pytest --cov=src/smarthome_mock_ai --cov-report=html
```

### ä»£ç è§„èŒƒæ£€æŸ¥

```bash
# è¿è¡Œ ruff æ£€æŸ¥
poetry run ruff check .

# è‡ªåŠ¨ä¿®å¤é—®é¢˜
poetry run ruff check . --fix

# æ ¼å¼åŒ–ä»£ç 
poetry run ruff format .
```

## ğŸ§ª CI/CD æµæ°´çº¿

é¡¹ç›®ä½¿ç”¨ GitHub Actions è¿›è¡ŒæŒç»­é›†æˆï¼š

- **è§¦å‘æ¡ä»¶**: `push` å’Œ `pull_request` åˆ° `main` æˆ– `develop` åˆ†æ”¯
- **Python ç‰ˆæœ¬**: æµ‹è¯• Python 3.10, 3.11, 3.12
- **æ£€æŸ¥é¡¹ç›®**:
  - ä»£ç å®‰è£…
  - Ruff ä»£ç è§„èŒƒæ£€æŸ¥
  - Ruff æ ¼å¼æ£€æŸ¥
  - Pytest æµ‹è¯•æ‰§è¡Œ
  - ä»£ç è¦†ç›–ç‡ä¸Šä¼ 

## ğŸ”® ä½¿ç”¨ç¤ºä¾‹

### Python API ä½¿ç”¨

```python
from smarthome_mock_ai.simulator import HomeSimulator
from smarthome_mock_ai.agent import SmartHomeAgent
import asyncio

# åˆå§‹åŒ–
simulator = HomeSimulator()
agent = SmartHomeAgent(simulator)

# å¤„ç†è‡ªç„¶è¯­è¨€æŒ‡ä»¤
async def control_home():
    # å•ä¸ªæŒ‡ä»¤
    result = await agent.process("æ‰“å¼€å®¢å…ç¯")
    print(result)

    # åœºæ™¯æŒ‡ä»¤
    result = await agent.process("æˆ‘è¦ç¡è§‰äº†")
    # è¾“å‡º: âœ“ å·²å…³é—­ å®¢å…ç¯
    #       âœ“ å·²å…³é—­ å§å®¤ç¯
    #       âœ“ å·²å…³é—­ å¨æˆ¿ç¯
    #       âœ“ å·²å…³é—­ æµ´å®¤ç¯

    # å¤åˆæŒ‡ä»¤
    result = await agent.process("æŠŠæ¸©åº¦è°ƒåˆ°25åº¦,æ‰“å¼€é£æ‰‡")
    print(result)

asyncio.run(control_home())
```

### ç›´æ¥ä½¿ç”¨æ¨¡æ‹Ÿå™¨

```python
from smarthome_mock_ai.simulator import HomeSimulator

# åˆ›å»ºæ¨¡æ‹Ÿå™¨
sim = HomeSimulator()

# ç›´æ¥æ§åˆ¶è®¾å¤‡
sim.turn_on_light("living_room_light")
sim.set_temperature("thermostat", 24.5)
sim.set_fan_speed("living_room_fan", 2)

# æŸ¥çœ‹æ‰€æœ‰è®¾å¤‡çŠ¶æ€
statuses = sim.get_all_statuses()
for device_id, status in statuses.items():
    print(f"{device_id}: {status}")

# æ‰¹é‡æ“ä½œ
sim.turn_off_all_lights()
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Python 3.10+**: ç°ä»£å¼‚æ­¥ç¼–ç¨‹ç‰¹æ€§
- **æ™ºè°±AI GLM-4**: å¤§è¯­è¨€æ¨¡å‹,æ”¯æŒ Function Calling
- **httpx**: å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
- **python-dotenv**: ç¯å¢ƒå˜é‡ç®¡ç†
- **Poetry**: ä¾èµ–ç®¡ç†å’Œæ‰“åŒ…
- **Pytest**: æµ‹è¯•æ¡†æ¶
- **Ruff**: å¿«é€Ÿçš„ Python ä»£ç æ£€æŸ¥å’Œæ ¼å¼åŒ–å·¥å…·
- **GitHub Actions**: CI/CD è‡ªåŠ¨åŒ–

## ğŸ“ å¼€å‘è·¯çº¿å›¾

- [x] é¡¹ç›®åˆå§‹åŒ–å’Œ CI/CD é…ç½®
- [x] å®ç° LLM å®¢æˆ·ç«¯å’Œ Function Calling
- [x] å¼€å‘è™šæ‹Ÿè®¾å¤‡ç®¡ç†å™¨
- [x] å®ç° AI Agent å’Œ CLI ç•Œé¢
- [ ] æ·»åŠ æ›´å¤šè®¾å¤‡ç±»å‹ (æ‰«åœ°æœºå™¨äººã€æ™ºèƒ½æ’åº§ç­‰)
- [ ] å®ç°äº‹ä»¶æ€»çº¿å’Œåœºæ™¯è”åŠ¨
- [ ] Web API æ¥å£
- [ ] å‰ç«¯æ§åˆ¶é¢æ¿

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ï¼è¯·å…ˆæŸ¥çœ‹ [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£è¯¦æƒ…ã€‚

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ‘¥ ä½œè€…

Your Name - [@your_username](https://github.com/your_username)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰å¼€æºé¡¹ç›®çš„è´¡çŒ®è€…
